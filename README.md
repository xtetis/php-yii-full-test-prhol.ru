# Тестовое задание

Установить advanced шаблон Yii2 фреймворка, в backend-приложении реализовать следующий закрытый функционал (доступ в backend-приложение должен производиться только по паролю, сложного разделения прав не требуется):

Написать класс/объект Apple с хранением яблок в БД MySql следуя ООП парадигме.

**Функции**

- упасть

- съесть ($percent - процент откушенной части)

- удалить (когда полностью съедено)

**Переменные**

- цвет (устанавливается при создании объекта случайным)

- дата появления (устанавливается при создании объекта случайным unixTmeStamp)

- дата падения (устанавливается при падении объекта с дерева)

- статус (на дереве / упало)

- сколько съели (%)

- другие необходимые переменные, для определения состояния.

**Состояния**

- висит на дереве

- упало/лежит на земле

- гнилое яблоко

**Условия**

Пока висит на дереве - испортиться не может.

Когда висит на дереве - съесть не получится.

После лежания 5 часов - портится.

Когда испорчено - съесть не получится.

Когда съедено - удаляется из массива яблок.

**Пример результирующего скрипта:**

$apple = new Apple('green');

echo $apple-\>color; // green

$apple-\>eat(50); // Бросить исключение - Съесть нельзя, яблоко на дереве

echo $apple-\>size; // 1 - decimal

$apple-\>fallToGround(); // упасть на землю

$apple-\>eat(25); // откусить четверть яблока

echo $apple-\>size; // 0,75

На странице в приложении должны быть отображены все яблоки, которые на этой же странице можно сгенерировать в случайном кол-ве соответствующей кнопкой.

Рядом с каждым яблоком должны быть реализованы кнопки или формы соответствующие функциям (упасть, съесть  процент…) в задании.

Задача не имеет каких-либо ограничений и требований. Все подходы к ее решению определяют способность выбора правильного алгоритма при проектировании системы и умение предусмотреть любые возможности развития алгоритма. Задание должно быть выложено в репозиторий на gitHub, с сохранением истории коммитов. Креативность только приветствуется.

# Решение

**Для запуска Docker**
./run.sh (https://bitbucket.org/xtetis/php-yii-full-test-prhol.ru/src/master/run.sh)
(оно -то можно использовать и тот что в дистрибутиве, но что-то у меня некорректно работал, потомуиспользую свой docker-compose.yml)

**Создания пользователя для авторизации**
Фронтенд доступен по адресу localhost, а бэкенд по http://back.localhost/
Для доступа к бэкенду можно или с помощью миграций создать стандартную таблицу пользователей и уже во фронтенде зарегистрировать пользователя. Или просто импортировать в базу SQL (https://bitbucket.org/xtetis/php-yii-full-test-prhol.ru/src/master/db/docker_db.sql)

**Переход к тестовому заданию**
Ссылка на тестовое задание (http://back.localhost/test/index) доступна только для авторизированных в бэкенде пользователей.

Также в контроллере **TestController.php** (https://bitbucket.org/xtetis/php-yii-full-test-prhol.ru/src/master/web/framework/backend/controllers/TestController.php) запрещено выполнение для неавторизировнных пользователей.

Класс, который было предложено реализовать **Apple.php** (https://bitbucket.org/xtetis/php-yii-full-test-prhol.ru/src/master/web/framework/backend/models/Apple.php).

Все JS события обрабатываются в файле https://bitbucket.org/xtetis/php-yii-full-test-prhol.ru/src/master/web/framework/backend/web/js/test.js

Думаю, описание и ссылки на View и Layout - будет лишними.





